{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/dabookofeli/dar-spec/spec/dar-schema.json",
  "title": "Digital Action Receipt (DAR) â€” Envelope",
  "description": "Non-authoritative JSON Schema for a DAR envelope containing a canonicalized payload and optional metadata (e.g., signature). The normative definition is in dar-core.md.",
  "type": "object",
  "required": ["payload"],
  "properties": {
    "payload": {
      "$ref": "dar-payload-schema.json",
      "description": "The core DAR payload. Canonicalization, hashing, and signing are performed over this object only."
    },
    "signature": {
      "type": "object",
      "description": "Optional cryptographic signature over the canonicalized payload bytes.",
      "required": ["algorithm", "key_id", "value"],
      "properties": {
        "algorithm": {
          "type": "string",
          "minLength": 1,
          "description": "The signature algorithm used (e.g., ed25519)."
        },
        "key_id": {
          "type": "string",
          "minLength": 1,
          "description": "Identifier for the signing key."
        },
        "value": {
          "type": "string",
          "minLength": 1,
          "description": "Base64-encoded signature value."
        }
      },
      "additionalProperties": false
    },
    "receipt_hash": {
      "type": "string",
      "description": "Optional convenience field: derived SHA-256 hash of the canonicalized payload. Not part of the payload and not required for verifiability."
    },
    "locator": {
      "type": "string",
      "description": "Optional retrieval hint (URI/URL/URN). Not part of the payload."
    }
  },
  "additionalProperties": false
}
